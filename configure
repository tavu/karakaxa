#!/bin/bash
DIR=`pwd`
TARGET=$DIR/target

#making the library

cd src/lib
qmake -project  -o lib.pro.tmp
echo "TEMPLATE = lib" > lib.pro
cat lib.pro.tmp|grep -v TEMPLATE >>lib.pro
rm lib.pro.tmp
cat $DIR/qmakeadd >>lib.pro
echo "OBJECTS_DIR=$DIR/build/libs" >>lib.pro
echo "MOC_DIR=$DIR/build/moc" >>lib.pro
echo "TARGET = $TARGET/player" >>lib.pro

qmake lib.pro



#making the main application
cd $DIR/src/player
qmake -project  -o application.pro
echo "OBJECTS_DIR=$DIR/build" >>application.pro
echo "MOC_DIR=$DIR/build/moc" >>application.pro

cat $DIR/qmakeadd >>application.pro
echo "LIBS += -L$TARGET -lplayer" >>application.pro
echo "INCLUDEPATH += ../lib/core" >>application.pro
echo "INCLUDEPATH += ../lib/files">>application.pro
echo "INCLUDEPATH += ../lib/views">>application.pro
echo "TARGET = $TARGET/player" >>application.pro

qmake application.pro

#creating the main makefile
cd $DIR
qmake 