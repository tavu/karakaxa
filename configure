#!/bin/bash
DIR=`pwd`
TARGET=$DIR/target

#-Wall
#qmake will report all known warnings.
#-Wnone
#No warning information will be generated by qmake.
#-Wparser
#qmake will only generate parser warnings. This will alert you to common pitfalls and potential problems in the parsing of your project files.
#-Wlogic
#qmake will warn of common pitfalls and potential problems in your project file. 


#making the library

cd src/lib
qmake -project   -o lib.pro.tmp
echo "TEMPLATE = lib" > lib.pro
cat lib.pro.tmp|grep -v TEMPLATE >>lib.pro
rm lib.pro.tmp
cat $DIR/qmakeadd >>lib.pro
echo "OBJECTS_DIR=$DIR/build/libs" >>lib.pro
echo "MOC_DIR=$DIR/build/moc" >>lib.pro
echo "TARGET = $TARGET/player" >>lib.pro
echo "QMAKE_CXXFLAGS_DEBUG = -Wno-reorder " >>lib.pro

qmake -Wlogic  lib.pro



#making the main application
cd $DIR/src/player
qmake -project  -o application.pro
echo "OBJECTS_DIR=$DIR/build" >>application.pro
echo "MOC_DIR=$DIR/build/moc" >>application.pro

cat $DIR/qmakeadd >>application.pro
echo "LIBS += -L$TARGET -lplayer" >>application.pro
echo "INCLUDEPATH += ../lib/core" >>application.pro
echo "INCLUDEPATH += ../lib/files">>application.pro
echo "INCLUDEPATH += ../lib/views">>application.pro
echo "TARGET = $TARGET/player" >>application.pro
echo "QMAKE_CXXFLAGS_DEBUG = -Wno-reorder " >>application.pro

qmake -Wlogic  application.pro

#creating the main makefile
cd $DIR
qmake -Wlogic 